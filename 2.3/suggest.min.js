if(!Suggest)var Suggest={};Suggest.Key={TAB:9,RETURN:13,ESC:27,UP:38,DOWN:40};Suggest.copyProperties=function(a,b){for(var c in b)a[c]=b[c];return a};Suggest.Local=function(){this.initialize.apply(this,arguments)};
Suggest.Local.prototype={initialize:function(a,b,c,d){this.input=this._getElement(a);this.suggestArea=this._getElement(b);this.candidateList=c;this.oldText=this.getInputText();d&&this.setOptions(d);this._addEvent(this.input,"focus",this._bind(this.checkLoop));this._addEvent(this.input,"blur",this._bind(this.inputBlur));this._addEvent(this.suggestArea,"blur",this._bind(this.inputBlur));a="keydown";if(window.opera||0<=navigator.userAgent.indexOf("Gecko")&&-1==navigator.userAgent.indexOf("KHTML"))a=
"keypress";this._addEvent(this.input,a,this._bindEvent(this.keyEvent));this.clearSuggestArea()},interval:500,dispMax:20,listTagName:"div",prefix:!1,ignoreCase:!0,highlight:!1,dispAllKey:!1,classMouseOver:"over",classSelect:"select",hookBeforeSearch:function(){},setOptions:function(a){Suggest.copyProperties(this,a)},inputBlur:function(){setTimeout(this._bind(function(){document.activeElement==this.suggestArea||document.activeElement==this.input||(this.changeUnactive(),this.oldText=this.getInputText(),
this.timerId&&clearTimeout(this.timerId),this.timerId=null,setTimeout(this._bind(this.clearSuggestArea),500))},500))},checkLoop:function(){var a=this.getInputText();a!=this.oldText&&(this.oldText=a,this.search());this.timerId&&clearTimeout(this.timerId);this.timerId=setTimeout(this._bind(this.checkLoop),this.interval)},search:function(){this.clearSuggestArea();var a=this.getInputText();""==a||null==a||(this.hookBeforeSearch(a),a=this._search(a),0!=a.length&&this.createSuggestArea(a))},_search:function(a){var b=
[],c;this.suggestIndexList=[];for(var d=0,e=this.candidateList.length;d<e;d++)if(null!=(c=this.isMatch(this.candidateList[d],a)))if(b.push(c),this.suggestIndexList.push(d),0!=this.dispMax&&b.length>=this.dispMax)break;return b},isMatch:function(a,b){if(null==a)return null;var c=this.ignoreCase?a.toLowerCase().indexOf(b.toLowerCase()):a.indexOf(b);return-1==c||this.prefix&&0!=c?null:this.highlight?this._escapeHTML(a.substr(0,c))+"<strong>"+this._escapeHTML(a.substr(c,b.length))+"</strong>"+this._escapeHTML(a.substr(c+
b.length)):this._escapeHTML(a)},clearSuggestArea:function(){this.suggestArea.innerHTML="";this.suggestArea.style.display="none";this.activePosition=this.suggestIndexList=this.suggestList=null},createSuggestArea:function(a){this.suggestList=[];this.inputValueBackup=this.input.value;for(var b=0,c=a.length;b<c;b++){var d=document.createElement(this.listTagName);d.innerHTML=a[b];this.suggestArea.appendChild(d);this._addEvent(d,"click",this._bindEvent(this.listClick,b));this._addEvent(d,"mouseover",this._bindEvent(this.listMouseOver,
b));this._addEvent(d,"mouseout",this._bindEvent(this.listMouseOut,b));this.suggestList.push(d)}this.suggestArea.style.display="";this.suggestArea.scrollTop=0},getInputText:function(){return this.input.value},setInputText:function(a){this.input.value=a},keyEvent:function(a){this.timerId||(this.timerId=setTimeout(this._bind(this.checkLoop),this.interval));this.dispAllKey&&a.ctrlKey&&""==this.getInputText()&&!this.suggestList&&a.keyCode==Suggest.Key.DOWN?(this._stopEvent(a),this.keyEventDispAll()):a.keyCode==
Suggest.Key.UP||a.keyCode==Suggest.Key.DOWN?this.suggestList&&0!=this.suggestList.length&&(this._stopEvent(a),this.keyEventMove(a.keyCode)):a.keyCode==Suggest.Key.RETURN?this.suggestList&&0!=this.suggestList.length&&(this._stopEvent(a),this.keyEventReturn()):a.keyCode==Suggest.Key.ESC?this.suggestList&&0!=this.suggestList.length&&(this._stopEvent(a),this.keyEventEsc()):this.keyEventOther(a)},keyEventDispAll:function(){this.clearSuggestArea();this.oldText=this.getInputText();this.suggestIndexList=
[];for(var a=0,b=this.candidateList.length;a<b;a++)this.suggestIndexList.push(a);this.createSuggestArea(this.candidateList)},keyEventMove:function(a){this.changeUnactive();if(a==Suggest.Key.UP)if(null==this.activePosition)this.activePosition=this.suggestList.length-1;else{if(this.activePosition--,0>this.activePosition){this.activePosition=null;this.input.value=this.inputValueBackup;this.suggestArea.scrollTop=0;return}}else if(null==this.activePosition?this.activePosition=0:this.activePosition++,this.activePosition>=
this.suggestList.length){this.activePosition=null;this.input.value=this.inputValueBackup;this.suggestArea.scrollTop=0;return}this.changeActive(this.activePosition)},keyEventReturn:function(){this.clearSuggestArea();this.moveEnd()},keyEventEsc:function(){this.clearSuggestArea();this.input.value=this.inputValueBackup;this.oldText=this.getInputText();window.opera&&setTimeout(this._bind(this.moveEnd),5)},keyEventOther:function(){},changeActive:function(a){this.setStyleActive(this.suggestList[a]);this.setInputText(this.candidateList[this.suggestIndexList[a]]);
this.oldText=this.getInputText();this.input.focus()},changeUnactive:function(){null!=this.suggestList&&(0<this.suggestList.length&&null!=this.activePosition)&&this.setStyleUnactive(this.suggestList[this.activePosition])},listClick:function(a,b){this.changeUnactive();this.activePosition=b;this.changeActive(b);this.clearSuggestArea();this.moveEnd()},listMouseOver:function(a){this.setStyleMouseOver(this._getEventElement(a))},listMouseOut:function(a,b){if(this.suggestList){var c=this._getEventElement(a);
b==this.activePosition?this.setStyleActive(c):this.setStyleUnactive(c)}},setStyleActive:function(a){a.className=this.classSelect;var b=a.offsetTop,a=b+a.clientHeight;this.suggestArea.scrollTop>b?this.suggestArea.scrollTop=b:this.suggestArea.scrollTop+this.suggestArea.clientHeight<a&&(this.suggestArea.scrollTop=a-this.suggestArea.clientHeight)},setStyleUnactive:function(a){a.className=""},setStyleMouseOver:function(a){a.className=this.classMouseOver},moveEnd:function(){if(this.input.createTextRange){this.input.focus();
var a=this.input.createTextRange();a.move("character",this.input.value.length);a.select()}else this.input.setSelectionRange&&this.input.setSelectionRange(this.input.value.length,this.input.value.length)},_getElement:function(a){return"string"==typeof a?document.getElementById(a):a},_addEvent:window.addEventListener?function(a,b,c){a.addEventListener(b,c,!1)}:function(a,b,c){a.attachEvent("on"+b,c)},_stopEvent:function(a){a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.returnValue=!1,
a.cancelBubble=!0)},_getEventElement:function(a){return a.target||a.srcElement},_bind:function(a){var b=this,c=Array.prototype.slice.call(arguments,1);return function(){a.apply(b,c)}},_bindEvent:function(a){var b=this,c=Array.prototype.slice.call(arguments,1);return function(d){d=d||window.event;a.apply(b,[d].concat(c))}},_escapeHTML:function(a){return a.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;")}};
Suggest.LocalMulti=function(){this.initialize.apply(this,arguments)};Suggest.copyProperties(Suggest.LocalMulti.prototype,Suggest.Local.prototype);Suggest.LocalMulti.prototype.delim=" ";Suggest.LocalMulti.prototype.keyEventReturn=function(){this.clearSuggestArea();this.input.value+=this.delim;this.moveEnd()};
Suggest.LocalMulti.prototype.keyEventOther=function(a){a.keyCode==Suggest.Key.TAB&&(this.suggestList&&0!=this.suggestList.length)&&(this._stopEvent(a),this.activePosition||(this.activePosition=0,this.changeActive(this.activePosition)),this.clearSuggestArea(),this.input.value+=this.delim,window.opera?setTimeout(this._bind(this.moveEnd),5):this.moveEnd())};
Suggest.LocalMulti.prototype.listClick=function(a,b){this.changeUnactive();this.activePosition=b;this.changeActive(b);this.input.value+=this.delim;this.clearSuggestArea();this.moveEnd()};Suggest.LocalMulti.prototype.getInputText=function(){var a=this.getLastTokenPos();return-1==a?this.input.value:this.input.value.substr(a+1)};Suggest.LocalMulti.prototype.setInputText=function(a){var b=this.getLastTokenPos();this.input.value=-1==b?a:this.input.value.substr(0,b+1)+a};
Suggest.LocalMulti.prototype.getLastTokenPos=function(){return this.input.value.lastIndexOf(this.delim)};